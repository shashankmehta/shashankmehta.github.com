<!DOCTYPE html>
<html lang="{{ site.language | default: 'en' }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    {% if title %}
      {{ title }} &ndash;
    {% endif %}
    {{ site.title }}
  </title>
  <meta name="description" content="{{ site.description }}">
  <!-- Set theme immediately to prevent flash -->
  <script>
    // Immediately set the theme before any content renders
    (function() {
      const storedTheme = localStorage.getItem('theme');
      const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
      
      if (storedTheme === 'dark') {
        document.documentElement.dataset.theme = 'dark';
      } else if (storedTheme === 'light') {
        document.documentElement.dataset.theme = 'light';
      } else {
        // System preference
        document.documentElement.dataset.theme = prefersDarkScheme.matches ? 'dark' : 'light';
      }
    })();
  </script>
  <link rel="stylesheet" href="/css/main.css">
  
  {% if og_image %}
    <meta property="og:image" content="{{site.url}}/images/posts/{{ og_image }}" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="{{site.url}}/images/posts/{{ og_image}}" />
  {% endif %}

  {% if title %}
    <meta property="og:title" content="{{ title }}" />
    <meta name="twitter:title" content="{{ title }}">
  {% endif %}

  {% if description %}
    <meta property="og:description" content="{{ description }}" />
    <meta property="twitter:description" content="{{ description }}" />
  {% endif %}

  <meta property="og:type" content="article" />
  <meta name="twitter:site" content="@{{ site.twitter }}">
  <meta name="twitter:creator" content="@{{ site.twitter }}">
  <meta name="twitter:url" content="{{site.url}}{{page.url}}">
</head>